---
title: "RWorksheet_guion#4c.Rmd."
author: "Mikyla Grace Guion"
date: "2024-10-30"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# 1.
# a. Show your solutions on how to import a csv file into the environment.
```{r}
write.csv(mpg, "mpg.csv", row.names = FALSE)

mpg_data <- read.csv("mpg.csv")

```
# b. Which variables from mpg dataset are categorical?
```{r}
str(mpg_data)
```
The categorical variables are manufacturer, model, trans, drv, fl, and class.

# c. Which are continuous variables?
The continous variables are displ, year, cyl, cty, and hwy.
# 2. Which manufacturer has the most models in this data set? Which model has the most variations? Show your answer.
```{r}
manufacturer_count <- mpg %>%
  group_by(manufacturer) %>%
  summarise(num_models = n_distinct(model)) %>%
  arrange(desc(num_models))

manufacturer_count[1, ]

model_count <- mpg %>%
  group_by(model) %>%
  summarise(num_variations = n()) %>%
  arrange(desc(num_variations))

model_count[1, ]
```

# a. Group the manufacturers and find the unique models. Show your codes and result.
```{r}
unique_models <- mpg %>%
  group_by(manufacturer) %>%
  summarise(unique_models_count = n_distinct(model))

unique_models
```
# b. Graph the result by using plot() and ggplot(). Write the codes and its result.
```{r}
barplot(
  unique_models$unique_models_count,
  names.arg = unique_models$manufacturer,
  las = 2,                    # Make x-axis labels vertical for better readability
  col = "lightblue",
  main = "Number of Unique Models by Manufacturer",
  xlab = "Manufacturer",
  ylab = "Unique Models Count"
)

ggplot(unique_models, aes(x = reorder(manufacturer, -unique_models_count), y = unique_models_count)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Number of Unique Models by Manufacturer", x = "Manufacturer", y = "Unique Models Count") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
# 2. Same dataset will be used. You are going to show the relationship of the modeland the manufacturer.

# a. What does ggplot(mpg, aes(model, manufacturer)) + geom_point() show?
```{r}
mpg_summary <- mpg %>%
  group_by(manufacturer, model) %>%
  summarise(count = n()) %>%
  ungroup()

ggplot(mpg_summary, aes(x = reorder(model, count), y = manufacturer)) +
  geom_point(aes(size = count, color = count)) +
  labs(title = "Relationship between Model and Manufacturer with Frequency",
       x = "Model",
       y = "Manufacturer",
       size = "Frequency",
       color = "Frequency") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))
```

# b. For you, is it useful? If not, how could you modify the data to make it more informative?

# 3. Plot the model and the year using ggplot(). Use only the top 20 observations. Write the codes and its results.
```{r}
top_20_mpg <- mpg %>% 
  slice_head(n = 20)

ggplot(top_20_mpg, aes(x = model, y = year)) +
  geom_point(color = "pink", size = 3) +
  labs(title = "Top 20 Observations of Model vs. Year",
       x = "Model",
       y = "Year") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


# 4. Using the pipe (%>%), group the model and get the number of cars per model. Show codes and its result
```{r}
car_counts <- mpg_data %>%
  group_by(model) %>%
  summarise(count = n()) %>%
  arrange(desc(count))
```
# a. Plot using geom_bar() using the top 20 observations only. The graphs shoudl have a title, labels and colors. Show code and results.
```{r}
top_20 <- head(car_counts, 20)

ggplot(top_20, aes(x = reorder(model, count), y = count, fill = count)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 20 Car Models by Count",
       x = "Car Model",
       y = "Number of Cars") +
  scale_fill_gradient(low = "blue", high = "red") + 
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


# b. Plot using the geom_bar() + coord_flip() just like what is shown below. Show codes and its result.
```{r}
ggplot(top_20, aes(x = reorder(model, count), y = count, fill = count)) +
  geom_bar(stat = "identity") +
  labs(title = "Top 20 Car Models by Count (Horizontal)",
       x = "Number of Cars",
       y = "Car Model") +
  scale_fill_gradient(low = "blue", high = "red") +  # Color gradient
  theme_minimal() +
  coord_flip()
```

# 5. Plot the relationship between cyl - number of cylinders and displ - engine displacement using geom_point with aesthetic color = engine displacement. Title should be “Relationship between No. of Cylinders and Engine Displacement”.
```{r}
ggplot(mpg_data, aes(x = cyl, y = displ, color = displ)) +
  geom_point(size = 3, alpha = 0.7) +  # Adjust point size and transparency
  labs(title = "Relationship between No. of Cylinders and Engine Displacement",
       x = "Number of Cylinders",
       y = "Engine Displacement (L)") +
  scale_color_gradient(low = "blue", high = "red") + 
  theme_minimal()
```
# a. How would you describe its relationship? Show the codes and its result.

# 6. Plot the relationship between displ (engine displacement) and hwy(highway miles per gallon). Mapped it with a continuous variable you have identified in #1-c. What is its result? Why it produced such output?
```{r}
ggplot(mpg_data, aes(x = displ, y = hwy, color = cty)) +
  geom_point(size = 3, alpha = 0.7) + 
  labs(title = "Relationship between Engine Displacement and Highway MPG",
       x = "Engine Displacement (L)",
       y = "Highway Miles per Gallon (MPG)") +
  scale_color_gradient(low = "blue", high = "red") +
  theme_minimal()
```

# 6. Import the traffic.csv onto your R environment.
```{r}
write.csv(traffic, "traffic.csv", row.names = FALSE)

traffic_data <- read.csv("traffic.csv")
```
# a. How many numbers of observation does it have? What are the variables of the traffic dataset the Show your answer.
```{r}
length(traffic_data)

variable_names <- names(traffic_data)

variable_names
```


# b. subset the traffic dataset into junctions. What is the R codes and its output?

# c. Plot each junction in a using geom_line(). Show your solution and output.

# 7. From alexa_file.xlsx, import it to your environment
```{r}
alexa_data <- read_excel("alexa_file.xlsx")
```


# a. How many observations does alexa_file has? What about the number of columns? Show your solution and answer.

# b. group the variations and get the total of each variations. Use dplyr package. Show solution and answer.

# c. Plot the variations using the ggplot() function. What did you observe? Complete the details of the graph. Show solution and answer.

# d. Plot a geom_line() with the date and the number of verified reviews. Complete the details of the graphs. Show your answer and solution.

# e. Get the relationship of variations and ratings. Which variations got the most highest in rating? Plot a graph to show its relationship. Show your solution and answer.